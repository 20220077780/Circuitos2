clc
close all
clear all

A = [
    1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;    %A
    -1 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0;   %B
    0 0 -1 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0;   %C
    0 0 0 -1 0 -1 0 1 0 0 0 0 0 0 0 0 0 0;  %D
    0 -1 0 0 0 0 -1 -1 1 0 0 0 0 0 0 0 0 0;  %E
    0 0 0 0 -1 0 0 0 0 1 1 1 -1 0 0 0 0 0;  %F
    0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0;  %G
%    0 0 0 -1 0 -1 0 1 0 0 0 0 0 0 0 0 0 0; %H
    0 0 0 0 0 0 0 0 0 -1 0 0 0 0 -1 0 1 0;  %I
    0 0 0 0 0 0 0 0 0 0 -1 0 0 0 0 0 -1 1;  %J
    0 0 0 0 0 0 0 0 0 0 0 -1 0 0 0 -1 0 -1  %K
    ];
At = transpose(A); 

Js = [
        -2;
        0;
        -2;
        0;
        -1;
        0;
        0;
        0;
        0;
        2;
        0;
        0;
        3;
        -1;
        0;
        0;
        0;
        0
    ]; 
Vs= [0;0;0;0;0;0;0;0;0;0;0;24;0;0;0;0;0;0]; 
Yb = diag([1/6, 1/2, 1/2, 1/5, 1, 1/10, 1/5, 1/5, 1, 1/2, 1/10, 1/10, 1/4, 1, 1/4, 1/5, 1/4, 1]);

Yn = A*Yb*transpose(A)
Is = -A*Js + A*Yb*Vs

%   Tensões de nó (E), tensões de ramo (V) e correntes de ramo (J):

E = inv(Yn)*Is
V = transpose(A)*E
J = Js + Yb*V - Yb*Vs;